## 微信小程序分包处理方案

### 项目分析

**当前结构**：
- 主包包含所有页面，包括核心页面和子应用页面
- 子应用位于`subgames`目录下，共有9个独立子应用
- 主包尺寸超过1.5M，需要进行分包处理

**子应用列表**：
1. 28Stars
2. 64Hexagrams
3. 72DreamlandPoetryTravel
4. VegetableRootSayings
5. WuxingMysteries
6. daily-character
7. family
8. future
9. guardian-beast

### 分包方案

**核心思路**：将每个子应用作为一个独立子包，主包只保留核心页面。

**具体配置**：

1. **修改app.json配置**：
   - 保留主包核心页面在`pages`数组中
   - 添加`subPackages`配置，为每个子应用创建单独的子包
   - 移除子应用页面从`pages`数组中

2. **主包页面保留**：
   ```json
   "pages": [
     "pages/index/index",
     "pages/game/game",
     "pages/about/about",
     "pages/zhuoqixuan/index"
   ]
   ```

3. **子包配置**：
   ```json
   "subPackages": [
     {
       "root": "subgames/28Stars",
       "pages": [
         "index",
         "pages/constellation-map/constellation-map",
         "pages/star-matching/star-matching"
       ]
     },
     {
       "root": "subgames/64Hexagrams",
       "pages": [
         "index",
         "pages/group-view/group-view",
         "pages/hexagram-detail/hexagram-detail",
         "pages/hexagram-list/hexagram-list",
         "pages/matching/matching"
       ]
     },
     {
       "root": "subgames/72DreamlandPoetryTravel",
       "pages": ["index"]
     },
     {
       "root": "subgames/VegetableRootSayings",
       "pages": ["index"]
     },
     {
       "root": "subgames/WuxingMysteries",
       "pages": [
         "index",
         "pages/main/index",
         "pages/wuxing/index",
         "pages/wufang/index",
         "pages/wuse/index",
         "pages/wuzang/index",
         "pages/detail/detail"
       ]
     },
     {
       "root": "subgames/daily-character",
       "pages": [
         "index",
         "pages/card/index",
         "pages/test/index",
         "pages/list/list"
       ]
     },
     {
       "root": "subgames/family",
       "pages": ["index"]
     },
     {
       "root": "subgames/future",
       "pages": ["index"]
     },
     {
       "root": "subgames/guardian-beast",
       "pages": [
         "index",
         "draw",
         "result",
         "poster",
         "knowledge/list",
         "knowledge/detail"
       ]
     }
   ]
   ```

### 技术要点

1. **路径配置**：
   - 每个子包的`root`路径指向对应的子应用目录
   - 子包内的页面路径是相对于`root`的相对路径

2. **页面访问**：
   - 分包页面的访问路径保持不变，例如：`subgames/daily-character/index`
   - 微信会自动处理分包的加载

3. **注意事项**：
   - 确保每个子包的页面路径正确
   - 主包和分包之间的资源引用需要注意路径问题
   - 分包加载是按需加载，首次进入分包页面时会下载对应分包

4. **验证步骤**：
   - 修改app.json配置
   - 在微信开发者工具中查看分包大小
   - 测试所有页面是否能正常访问
   - 确认主包尺寸已减小到1.5M以下

### 预期效果

- **主包尺寸**：大幅减小，预计在1M以下
- **分包尺寸**：每个子包单独计算，按需加载
- **加载性能**：首次启动速度提升，分包页面按需加载
- **维护性**：子应用结构更清晰，便于独立维护

### 实施步骤

1. 备份当前的app.json文件
2. 修改app.json，移除子应用页面并添加subPackages配置
3. 保存修改并在微信开发者工具中查看效果
4. 测试所有页面的访问情况
5. 验证分包大小和加载性能