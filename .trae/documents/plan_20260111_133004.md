# 补充完善data-optimized.js数据（使用DeepSeek API）

## 任务目标
使用DeepSeek API逐项完善data-optimized.js中的每个字的数据，包括错误读音、关联词组、字典解释、错误原因分类和难度等级。

## 数据结构分析

### 当前数据结构
- **id**: 字ID
- **char**: 汉字
- **correctPronunciation**: 正确读音
- **wrongPronunciations**: 错误读音列表（数组）
- **relatedPhrases**: 关联词组（数组）
- **explanation**: 字典解释
- **errorReasonType**: 常见错误原因分类
- **difficultyLevel**: 测试难度等级（初级、中级、高级、挑战级）

### 当前状态
- 大部分字的errorReasonType都是4
- 大部分字的difficultyLevel都是"初级"
- 有些字的explanation字段为空或只有简单描述
- 有些字的wrongPronunciations数组长度不足3个
- 有些字的relatedPhrases数组长度不足4个

## 实现方案

### 步骤1: 创建数据完善脚本
创建Python脚本`enhance_data.py`，实现以下功能：
- 读取data-optimized.js文件
- 解析characters数组
- 遍历每个字，检查需要补充的字段
- 使用DeepSeek API查询补充数据
- 更新数据
- 保存更新后的数据

### 步骤2: 实现DeepSeek API集成
- 使用用户提供的API密钥（sk-dff3aead60d64901b5ecfe1a62043b00）
- 实现API调用函数
- 实现结果解析函数
- 处理API调用异常

### 步骤3: 实现数据查询功能

#### 3.1 错误读音查询
- **提示词**: `有此{char}字，读音为{correctPronunciation}，请查询其通常可能会读错的错误读音1到3个，直接返回错误读音列表，每个读音用逗号分隔，不要包含其他内容。`
- **解析策略**: 解析API返回的错误读音列表

#### 3.2 关联词组查询
- **提示词**: `有此{char}字，读音为{correctPronunciation}，含有此字念此音的关联词组1到4个，直接返回关联词组列表，每个词组用逗号分隔，不要包含其他内容。`
- **解析策略**: 解析API返回的关联词组列表

#### 3.3 字典解释查询
- **提示词**: `有此{char}字，读音为{correctPronunciation}，请给出字典对此字此读音的通常解释，直接返回解释内容，不要包含其他内容。`
- **解析策略**: 解析API返回的字典解释

#### 3.4 错误原因分类和难度等级查询
- **提示词**: `有此{char}字，读音为{correctPronunciation}，常见错误读音有{wrong_pronunciations}，请判断其常见错误原因分类（1:形声字误读, 2:多音字误读, 3:声母误读, 4:韵母误读, 5:声调误读, 6:形似字误读, 7:方言影响误读, 8:其他误读原因）和测试难度等级（初级、中级、高级、挑战级），直接返回分类数字和难度等级，用逗号分隔，不要包含其他内容。`
- **解析策略**: 解析API返回的错误原因分类和难度等级

### 步骤4: 制定错误原因分类规则
1. **1**: 形声字误读（如：炽zhì常误读为chì）
2. **2**: 多音字误读（如：巷hàng常误读为xiàng）
3. **3**: 声母误读（如：塑sù常误读为suò）
4. **4**: 韵母误读（如：氛fēn常误读为fèn）
5. **5**: 声调误读（如：处chǔ常误读为chù）
6. **6**: 形似字误读（如：诣yì常误读为zhǐ）
7. **7**: 方言影响误读（如：血xuè常误读为xiě）
8. **8**: 其他误读原因

### 步骤5: 制定难度等级划分规则
- **初级**: 常见字，错误读音较少，易于纠正
- **中级**: 较常见字，有一定的错误读音概率
- **高级**: 生僻字或多音字，错误读音较多
- **挑战级**: 非常生僻字，或有特殊读音规则的字

### 步骤6: 执行数据完善操作
- 运行脚本，逐个字处理
- 记录处理进度和结果
- 处理API调用异常

### 步骤7: 验证完善结果
- 查看更新后的data-optimized.js文件
- 确认数据格式正确
- 验证各字段内容是否符合要求
- 检查错误原因分类和难度等级的分布是否合理

## 关键处理逻辑

1. **错误读音补充**:
   - 如果wrongPronunciations为空，补充1-3个错误读音
   - 如果已有1个或以上，视情况补充，最多3个
   - 使用DeepSeek API查询

2. **关联词组补充**:
   - 补充1-3个含有此字念此音的关联词组
   - 最多4个关联词组
   - 使用DeepSeek API查询

3. **字典解释补充**:
   - 补充此字念此音时的字典解释
   - 使用DeepSeek API查询

4. **错误原因分类**:
   - 根据字的特点和错误读音的原因，判断分类
   - 使用DeepSeek API查询

5. **难度等级划分**:
   - 根据字的使用频率、错误概率、读音规则复杂度等因素划分
   - 使用DeepSeek API查询
   - 确保各难度等级的数量合理分布

## 预期输出
- 更新后的data-optimized.js文件
- 处理结果统计信息，包括：
  - 处理字数
  - 补充的错误读音数量
  - 补充的关联词组数量
  - 补充的字典解释数量
  - 各错误原因分类的分布
  - 各难度等级的分布

## 技术要点
- Python文件读写和JSON解析
- DeepSeek API集成和调用
- 提示词设计和优化
- 结果解析和处理
- 错误处理和异常管理
- 进度记录和统计分析