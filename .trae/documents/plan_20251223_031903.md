# 六十四卦学习优化方案（最终版）

## 一、核心调整思路
1. **创建分组看页面**：将分组看功能从首页分离，实现模块化设计，并添加返回按钮
2. **顶部按钮调整**：增加"分组看"按钮，形成三个按钮一行排列，并添加图标
3. **模式选择优化**：将"随机翻"和"六爻变"按钮排列到一行
4. **卦卡片布局优化**：调整卡片宽度、卦序号位置、卦别名和上下卦排列、卦辞文字居中
5. **六爻按钮布局优化**：调整到一行排列，确保小屏适配
6. **翻页按钮优化**：文字居中，宽度适中，整体居中
7. **配对页返回按钮调整**：从顶部移到底部

## 二、详细实现方案

### 1. 创建分组看页面
- **新建文件**：
  - `subgames/64Hexagrams/pages/group-view/group-view.js`（页面逻辑）
  - `subgames/64Hexagrams/pages/group-view/group-view.wxml`（页面结构）
  - `subgames/64Hexagrams/pages/group-view/group-view.wxss`（页面样式）

- **迁移内容**：
  - 将首页中分组查看相关的代码迁移到新页面
  - 包括分组模式选择、卦象网格、分页控制等功能
  - 保留顺序分组和八宫分组功能
  - **添加返回按钮**：在页面底部添加返回按钮，返回首页

### 2. 首页功能调整
- **移除内容**：
  - 移除分组查看相关的代码
  - 移除模式选择中的"分组看"按钮

- **保留内容**：
  - 随机翻阅模式
  - 六爻变模式
  - 顶部按钮区域
  - 存卡片功能

### 3. 顶部按钮区域调整
- **修改位置**：`subgames/64Hexagrams/index.wxml` 第11-14行
- **实现内容**：
  - 增加"分组看"按钮，形成"存卡片"、"分组看"、"去识卦"三个按钮
  - 为每个按钮添加图标
  - 调整按钮样式，确保在一行显示，小屏适配
  - "分组看"按钮跳转新创建的分组看页面

### 4. 模式选择优化
- **修改位置**：`subgames/64Hexagrams/index.wxml` 第17-32行
- **实现内容**：
  - 将"随机翻"和"六爻变"按钮排列到一行
  - 移除"分组看"按钮（已移到顶部）
  - 调整按钮样式，确保在一行显示

### 5. 卦卡片布局优化
- **修改位置**：`subgames/64Hexagrams/index.wxml` 第84-133行（随机翻阅模式）和第135-199行（六爻变模式）
- **实现内容**：
  - **调整卡片宽度**：修改 `.random-card` 样式，确保不超出屏幕
  - **卦序号位置**：将 `.hexagram-sequence` 从中间移到右上角
  - **卦别名和上下卦排列**：确保 `.hexagram-extra-info` 内的元素在一行显示
  - **卦辞文字居中**：修改 `.hexagram-text` 样式，设置 `text-align: center`

### 6. 六爻按钮布局优化
- **修改位置**：`subgames/64Hexagrams/index.wxml` 第171-183行
- **实现内容**：
  - 调整 `.six-yao-buttons` 样式，确保六爻按钮在一行显示
  - 优化按钮尺寸和间距，确保小屏适配
  - 调整按钮内部布局，横向排列文字和符号

### 7. 翻页按钮优化
- **修改位置**：`subgames/64Hexagrams/index.wxml` 第120-129行和第185-195行
- **实现内容**：
  - 调整 `.random-page-button` 样式，文字居中，宽度适中
  - 调整 `.random-pagination` 样式，确保按钮整体居中
  - 调整提示文字 `.hint-text` 与按钮的间距，使其更靠近

### 8. 配对页返回按钮调整
- **修改位置**：`subgames/64Hexagrams/pages/matching/matching.wxml`
- **实现内容**：
  - 将返回按钮从顶部移到底部
  - 调整返回按钮样式，与页面整体风格一致

## 三、文件修改列表

### 1. 新建文件
- **分组看页面逻辑**：`subgames/64Hexagrams/pages/group-view/group-view.js`
- **分组看页面结构**：`subgames/64Hexagrams/pages/group-view/group-view.wxml`
- **分组看页面样式**：`subgames/64Hexagrams/pages/group-view/group-view.wxss`

### 2. 修改文件
- **首页布局文件**：`subgames/64Hexagrams/index.wxml`
  - 顶部按钮区域调整，增加"分组看"按钮
  - 模式选择按钮调整，移除"分组看"按钮
  - 卦卡片布局调整
  - 六爻按钮布局调整
  - 翻页按钮调整

- **首页样式文件**：`subgames/64Hexagrams/index.wxss`
  - 顶部按钮样式优化
  - 模式选择按钮样式优化
  - 卦卡片样式优化
  - 六爻按钮样式优化
  - 翻页按钮样式优化

- **首页逻辑文件**：`subgames/64Hexagrams/index.js`
  - 移除分组查看相关逻辑
  - 增加"分组看"按钮跳转逻辑

- **配对页布局文件**：`subgames/64Hexagrams/pages/matching/matching.wxml`
  - 返回按钮位置调整

- **配对页样式文件**：`subgames/64Hexagrams/pages/matching/matching.wxss`
  - 返回按钮样式调整

### 3. 配置文件
- **app.json**：
  - 添加新的分组看页面到页面配置

## 四、实现步骤

### 第一步：创建分组看页面
1. 创建新的分组看页面文件
2. 从首页迁移分组查看相关代码到新页面
3. 在分组看页面中添加返回按钮，返回首页
4. 调整新页面的逻辑和样式
5. 更新app.json配置

### 第二步：调整首页功能
1. 移除首页中的分组查看相关代码
2. 修改首页顶部按钮，增加"分组看"按钮
3. 调整模式选择按钮，移除"分组看"按钮
4. 优化卦卡片布局
5. 优化六爻按钮布局
6. 优化翻页按钮样式

### 第三步：调整配对页
1. 将返回按钮从顶部移到底部
2. 调整返回按钮样式

### 第四步：测试和优化
1. 测试页面间的导航逻辑
2. 测试分组看页面的功能和返回按钮
3. 测试小屏适配情况
4. 优化样式和交互细节

## 五、核心代码实现

### 1. 分组看页面创建
```javascript
// group-view.js
// 引入完整的六十四卦数据
const hexagramsData = require('../../hexagrams-data.js').hexagramsData;

Page({
    data: {
        // 分组相关
        groupMode: 'sequence', // 'sequence' 顺序, 'palace' 八宫
        currentPage: 0,
        totalGroups: 8,
        currentHexagrams: [],
        currentGroupTitle: '',
        currentGroupSubtitle: '',
        sequenceGroups: [],
        palaceGroups: []
    },
    
    onLoad() {
        this.initializeGroups();
        this.updateCurrentGroup();
    },
    
    // 初始化分组（从首页迁移）
    initializeGroups() {
        // 顺序分组 - 按《周易》原序，每组8个
        const sequenceGroups = [];
        for (let i = 0; i < 8; i++) {
            sequenceGroups.push({
                title: `第${i + 1}组`,
                subtitle: '按《周易》原序分组',
                hexagrams: hexagramsData.slice(i * 8, (i + 1) * 8)
            });
        }

        // 八宫分组 - 按八宫体系
        const palaceGroups = [
            // 八宫分组数据（从首页迁移）
        ];

        this.setData({
            sequenceGroups: sequenceGroups,
            palaceGroups: palaceGroups.map(group => ({
                ...group,
                hexagrams: group.hexagrams.map(id => hexagramsData.find(h => h.id === id))
            }))
        });
    },
    
    // 其他分组相关方法（从首页迁移）
    updateCurrentGroup() {},
    switchToSequence() {},
    switchToPalace() {},
    previousGroup() {},
    nextGroup() {},
    goToHexagramDetail() {},
    
    // 返回首页
    goBack() {
        wx.navigateBack();
    }
});
```

### 2. 分组看页面返回按钮
```html
<!-- group-view.wxml -->
<!-- 返回按钮 -->
<view class="back-button-container">
  <button class="back-button" bindtap="goBack">
    <text class="button-icon">←</text>
    <text>返回首页</text>
  </button>
</view>
```

### 3. 首页顶部按钮调整
```html
<!-- index.wxml -->
<view class="top-buttons">
  <button class="primary-button" bindtap="saveHexagramCard">
    <text class="button-icon">📷</text>
    <text>存卡片</text>
  </button>
  <button class="secondary-button" bindtap="goToGroupView">
    <text class="button-icon">📚</text>
    <text>分组看</text>
  </button>
  <button class="secondary-button" bindtap="goToMatchingGame">
    <text class="button-icon">🎮</text>
    <text>去识卦</text>
  </button>
</view>
```

### 4. 首页模式选择调整
```html
<!-- index.wxml -->
<view class="mode-selector">
  <view class="mode-buttons">
    <button 
      class="mode-button {{viewMode === 'random' ? 'active' : ''}}" 
      bindtap="switchToRandom"
    >随机翻</button>
    <button 
      class="mode-button {{viewMode === 'sixYaoChange' ? 'active' : ''}}" 
      bindtap="switchToSixYaoChange"
    >六爻变</button>
  </view>
</view>
```

### 5. 首页跳转逻辑调整
```javascript
// index.js
// 跳转到分组看页面
goToGroupView() {
    wx.navigateTo({
        url: '/subgames/64Hexagrams/pages/group-view/group-view'
    });
}
```

## 六、预期效果
1. **模块化设计**：分组看功能独立成页，代码结构更清晰
2. **分组看页面返回**：添加返回按钮，可返回首页
3. **顶部按钮优化**：三个按钮一行排列，带有图标，小屏适配良好
4. **模式选择简洁**："随机翻"和"六爻变"按钮一行排列，操作方便
5. **卦卡片布局合理**：不超出屏幕，卦序号在右上角，卦辞文字居中
6. **六爻按钮优化**：一行排列，操作便捷
7. **翻页按钮美观**：文字居中，宽度适中，整体居中
8. **配对页返回按钮调整**：底部返回，符合用户习惯
9. **小屏适配良好**：所有元素在小屏设备上均能良好显示

## 七、技术要点
1. **模块化设计**：将不同功能分离到独立页面，提高代码可维护性
2. **Flex布局优化**：使用flex布局实现按钮和元素的一行排列
3. **响应式设计**：通过媒体查询和弹性布局确保小屏适配
4. **图标使用**：为按钮添加图标，提升视觉效果和用户体验
5. **页面导航优化**：确保页面间的跳转逻辑清晰，用户体验流畅
6. **返回按钮添加**：在分组看页面添加返回按钮，确保用户可以返回首页