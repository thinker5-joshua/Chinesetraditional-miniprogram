# 修复难度选择按钮状态管理问题

**问题**：难度选择按钮一直保持选中状态，点击后闪一下又回到选中状态

**根本原因分析**：
1. 初始状态 `selectedDifficulties` 包含所有难度选项，默认四个按钮都选中
2. `onShow` 函数每次页面显示都读取本地存储，可能导致状态被意外重置
3. 状态切换时，`setData` 异步更新机制可能导致UI闪烁
4. CSS样式中 `!important` 标志可能导致样式优先级过高

**解决方案**：

1. **修复初始状态逻辑**：
   - 在 `onLoad` 中读取本地存储，而不是 `onShow`
   - 如果没有缓存，设置默认状态并保存到缓存
   - 避免每次页面显示都重置状态

2. **优化 `toggleDifficulty` 函数**：
   - 确保状态切换逻辑正确
   - 使用全新的数组引用
   - 避免直接修改原数组

3. **简化CSS样式**：
   - 移除不必要的 `!important` 标志
   - 确保样式优先级正确
   - 保留直接的 `.difficulty-option.active` 选择器

4. **增强状态管理**：
   - 确保状态变更的完整性
   - 添加详细的调试日志
   - 验证状态变更的原子性

**预期效果**：
- 首次加载时，优先读取缓存中的状态
- 如果没有缓存，默认选中所有难度并保存到缓存
- 点击按钮后能正确切换选中/未选中状态
- 状态变更后能正确保存到本地存储
- 页面重新加载时能正确恢复上次的选择状态

**修改文件**：
- `/Users/joshua/Documents/GitHub/Chinesetraditional-miniprogram/subgames/daily-character/index.js` - 修改JavaScript逻辑
- `/Users/joshua/Documents/GitHub/Chinesetraditional-miniprogram/subgames/daily-character/index.wxss` - 优化CSS样式