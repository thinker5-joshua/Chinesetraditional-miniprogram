<view class="container">
  <view class="game-header">
    <text class="game-title">成语消除</text>
    <text class="game-description">将四字成语拆分为两字一组，找出正确的配对组合，完成所有成语配对即可获胜。将逐级增加难度呢，快来挑战你的成语知识吧！</text>
  </view>
  
  <view class="game-info">
    <view class="level-info">
      <text class="level-text">{{levelName}}</text>
      <text class="level-number">第{{currentLevel}}/{{totalLevels}}关</text>
    </view>
    <view class="progress-container">
      <view class="progress-label">游戏进度</view>
      <view class="progress-bar-wrapper">
        <view class="progress-bar" style="width: {{progressWidth}}%;"></view>
      </view>
      <view class="progress-text">{{completedCount}}/{{totalCount}}</view>
    </view>
    <view class="progress-area">
      <view class="stars-container">
        <view class="star {{currentStars >= 1 ? 'active' : ''}}">★</view>
        <view class="star {{currentStars >= 2 ? 'active' : ''}}">★</view>
        <view class="star {{currentStars >= 3 ? 'active' : ''}}">★</view>
        <view class="star {{currentStars >= 4 ? 'active' : ''}}">★</view>
        <view class="star {{currentStars >= 5 ? 'active' : ''}}">★</view>
      </view>
      
      <!-- 成功配对提示 -->
      <view class="completed-idiom {{showCompletedIdiom ? 'show' : ''}}" wx:if="{{lastCompletedIdiom}}">
        <text class="completed-idiom-text">{{lastCompletedIdiom}}</text>
      </view>
    </view>
  </view>
  
  <view class="game-board">
    <view 
      wx:for="{{wordBlocks}}" 
      wx:key="id"
      class="word-block {{item.selected ? 'selected' : ''}} {{item.matched ? 'matched' : ''}}"
      bindtap="selectWord"
      data-index="{{index}}"
    >
      <view class="word-inner">
        <text class="word-text">{{item.text}}</text>
      </view>
    </view>
  </view>
  
  <view class="selected-words">
    <text class="selected-content">已选择: {{selectedWordsDisplay}}</text>
  </view>
</view>

<!-- 游戏成功模态框 -->
<view class="modal" wx:if="{{showSuccessModal}}">
  <view class="modal-content {{currentLevel === totalLevels ? 'celebration-complete' : 'celebration-level'}}">
    <view class="celebration-particles" wx:if="{{currentLevel === totalLevels}}">
      <text class="particle">🎊</text>
      <text class="particle">🎉</text>
      <text class="particle">✨</text>
      <text class="particle">🏆</text>
      <text class="particle">🌟</text>
    </view>
    <view class="modal-header">
      <text class="modal-title" wx:if="{{currentLevel < totalLevels}}">🎊 恭喜晋级！</text>
      <text class="modal-title" wx:else>🏆 全部通关！</text>
    </view>
    <view class="modal-body">
      <text class="success-message" wx:if="{{currentLevel < totalLevels}}">🌟 太棒了！您成功完成{{levelName}}！</text>
      <text class="success-message" wx:else>🎊 恭喜您完成全部关卡！您是成语大师！</text>
      <view class="final-stats">
        <text class="stats-text" wx:if="{{currentLevel < totalLevels}}">准备挑战更高级别吧！</text>
        <text class="stats-text" wx:else>您已经掌握了所有成语，真是太厉害了！</text>
        <text class="final-stars">本关评级：<text class="stars-display">{{finalStars}}</text></text>
      </view>
      <text class="play-again-text" wx:if="{{currentLevel < totalLevels}}">继续努力，成为成语大师！</text>
      <text class="play-again-text" wx:else>感谢游玩，欢迎再次挑战！</text>
    </view>
    <view class="modal-footer">
      <button class="play-again-btn" bindtap="playAgain">重新开始</button>
      <button class="next-level-btn" bindtap="nextLevel" wx:if="{{currentLevel < totalLevels}}">下一关</button>
      <button class="complete-btn" bindtap="nextLevel" wx:else>返回首页</button>
    </view>
  </view>
</view>

