<view class="container">
  <view class="header">
    <text class="title">易经六十四卦配对</text>
    <text class="subtitle">通过配对练习学习易经六十四卦，了解中国传统哲学思想</text>
  </view>
  
  <view class="game-container">
    <view class="score-board">
      <view class="progress">
        <text>配对进度: <text class="progress-text">{{progressText}}</text></text>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{progressWidth}}%;"></view>
          <view class="progress-dots">
            <view class="progress-dot {{successCount >= 1 ? 'active' : ''}}"></view>
            <view class="progress-dot {{successCount >= 2 ? 'active' : ''}}"></view>
            <view class="progress-dot {{successCount >= 3 ? 'active' : ''}}"></view>
          </view>
        </view>
      </view>
    </view>
    
    <view class="game-board-container">
      <!-- 卦象列 -->
      <view class="hexagram-column">
        <view 
          wx:for="{{leftCards}}" 
          wx:key="id"
          class="hexagram-block {{item.selected ? 'selected' : ''}} {{item.matched ? 'matched-' + item.matchColor : ''}}"
          bindtap="selectCard"
          data-card="{{item}}"
          data-side="left"
          style="{{item.matched ? 'border-color: ' + item.matchColor + '; background-color: ' + item.matchColor + '20;' : ''}}"
        >
          <view class="hexagram-symbol">{{item.symbol}}</view>
        </view>
      </view>
      
      <!-- 卦名列 -->
      <view class="name-column">
        <view 
          wx:for="{{rightCards}}" 
          wx:key="id"
          class="hexagram-block {{item.selected ? 'selected' : ''}} {{item.matched ? 'matched-' + item.matchColor : ''}}"
          bindtap="selectCard"
          data-card="{{item}}"
          data-side="right"
          style="{{item.matched ? 'border-color: ' + item.matchColor + '; background-color: ' + item.matchColor + '20;' : ''}}"
        >
          <view class="hexagram-name">{{item.name}}</view>
          <view class="hexagram-pinyin">{{item.pinyin}}</view>
        </view>
      </view>
    </view>
    
    <view class="selected-info">
      <text>已选择: <text class="selected-display">{{selectedDisplay}}</text></text>
    </view>
  </view>
  
  <!-- 去学卦按钮 -->
  <view class="learn-hexagram-container">
    <button class="learn-hexagram-button" bindtap="goToLearnHexagrams">去学卦</button>
  </view>
</view>

<!-- 成功模态框 -->
<view class="modal" wx:if="{{showSuccessModal}}">
  <view class="modal-content">
    <text class="modal-title">恭喜您！</text>
    <text class="success-message">您已成功匹配所有三组卦象！</text>
    <view class="hexagram-info">
      <view class="hexagram-preview-list">
        <view 
          wx:for="{{matchedHexagrams}}" 
          wx:key="id"
          class="hexagram-preview-item large-preview"
          bindtap="showHexagramDetail"
          data-hexagram="{{item}}"
        >
          <view class="preview-symbol">{{item.symbol}}</view>
          <view class="preview-name">{{item.name}}</view>
        </view>
      </view>
    </view>
    <button class="play-again-button" bindtap="playAgain">再玩一次</button>
  </view>
</view>

<!-- 卦象详情模态框 -->
<view class="modal" wx:if="{{showDetailModal}}">
  <view class="modal-content detail-modal">
    <view class="modal-header">
      <text class="detail-title">{{selectedHexagram.name}}</text>
    </view>
    <view class="hexagram-detail-content">
      <view class="hexagram-symbol">{{selectedHexagram.symbol}}</view>
      <view class="hexagram-pinyin-detail">{{selectedHexagram.pinyin}}</view>
      <text class="hexagram-text">{{selectedHexagram.hexagramText}}</text>
      
      <text class="yao-title">爻辞：</text>
      <view wx:for="{{selectedHexagram.yaoTexts}}" wx:key="*this" class="yao-info">
        <text>{{item}}</text>
      </view>
    </view>
    <view class="modal-footer">
      <button class="close-button" bindtap="closeDetail">返回</button>
    </view>
  </view>
</view>